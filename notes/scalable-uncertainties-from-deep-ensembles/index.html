<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/ml-reviews/styles.cd26d764ef9aba2e9aa1.css" id="gatsby-global-css">.popover{position:relative;max-width:16rem;box-shadow:0 10px 15px -3px var(--shadow),0 4px 6px -2px rgba(0,0,0,.05);padding:1rem;border:1px solid var(--separator);border-radius:.5rem;background-color:var(--references-bg);max-height:16rem;overflow:hidden}.popover.no-max-width{max-width:90vw}.popover.with-markdown{font-size:.875rem}.popover h1{margin:0;padding:0;font-size:1rem}.popover ul{padding-left:1rem}.popover .more-content-blind{height:4rem;position:absolute;background:transparent;background:linear-gradient(0,var(--references-bg),var(--references-bg-80) 50%,var(--references-bg-0));top:12rem;width:100%;left:0}.tippy-box[data-animation=shift-away][data-state=hidden]{opacity:0}.tippy-box[data-animation=shift-away][data-state=hidden][data-placement^=top]{-webkit-transform:translateY(10px);transform:translateY(10px)}.tippy-box[data-animation=shift-away][data-state=hidden][data-placement^=bottom]{-webkit-transform:translateY(-10px);transform:translateY(-10px)}.tippy-box[data-animation=shift-away][data-state=hidden][data-placement^=left]{-webkit-transform:translateX(10px);transform:translateX(10px)}.tippy-box[data-animation=shift-away][data-state=hidden][data-placement^=right]{-webkit-transform:translateX(-10px);transform:translateX(-10px)}.reference{text-decoration:none}.reference:hover{color:var(--references-highlight)}.reference>div{padding-top:.5rem;padding-bottom:.5rem}.reference>div>p{margin:0;font-size:.875rem}.reference>div>ul{margin:0}.references-block{color:var(--references-text);padding:1rem;margin:1rem 0;border-radius:.5rem;background-color:var(--references-bg);transition:background-color .3s ease,color .3s ease}.references-block>div{margin-bottom:1rem}.references-block>hr{margin-left:auto;margin-right:auto;width:8rem}.references-block a{color:var(--references-text);transition:color .3s ease}.references-block>p:last-child{margin-bottom:0}.note-container{background:var(--note-bg);transition:background .3s ease}.note-container:first-child{border-left:none}.note-container .note-content,.note-container .obstructed-label{transition:opacity 75ms linear}.note-container .obstructed-label{display:block;color:var(--text);text-decoration:none;font-size:17px;line-height:40px;font-weight:500;-webkit-writing-mode:vertical-lr;-ms-writing-mode:tb-lr;writing-mode:vertical-lr;-webkit-text-orientation:sideways;text-orientation:sideways;margin-top:36px;top:0;bottom:0;left:0;position:absolute;background-color:transparent;width:40px;overflow:hidden;opacity:0;transition:color .3s ease;pointer-events:none}.note-container.note-container-highlighted{background:var(--references-bg);transition:background .3s ease}.note-content img{max-width:100%}@media screen and (max-width:800px){.note-container{padding:16px;width:100%;overflow-y:auto}}@media screen and (min-width:801px){.note-container{transition:box-shadow .1s linear,opacity 75ms linear,-webkit-transform .2s cubic-bezier(.19,1,.22,1);transition:box-shadow .1s linear,opacity 75ms linear,transform .2s cubic-bezier(.19,1,.22,1);transition:box-shadow .1s linear,opacity 75ms linear,transform .2s cubic-bezier(.19,1,.22,1),-webkit-transform .2s cubic-bezier(.19,1,.22,1);flex-shrink:0;width:625px;max-width:625px;top:0;position:sticky;flex-grow:1;border-left:1px solid var(--separator);padding:0}.note-content{overflow-y:auto;height:100%;padding:32px}.note-container-overlay{box-shadow:0 0 15px 3px var(--shadow)}.note-container-obstructed .note-content{opacity:0}.note-container-obstructed .obstructed-label{opacity:1;pointer-events:all}}.dark-mode-toggle{cursor:pointer;-webkit-transform:scale(.6);transform:scale(.6)}.dark-mode-toggle input{display:none}.dark-mode-toggle input+div{border-radius:50%;width:36px;height:36px;position:relative;box-shadow:inset 16px -16px 0 0 #fff;-webkit-transform:scale(1) rotate(-2deg);transform:scale(1) rotate(-2deg);transition:box-shadow .5s ease 0s,-webkit-transform .4s ease .1s;transition:box-shadow .5s ease 0s,transform .4s ease .1s;transition:box-shadow .5s ease 0s,transform .4s ease .1s,-webkit-transform .4s ease .1s}.dark-mode-toggle input+div:before{content:"";width:inherit;height:inherit;border-radius:inherit;position:absolute;left:0;top:0;transition:background .3s ease}.dark-mode-toggle input+div:after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0 0 -4px;position:absolute;top:50%;left:50%;box-shadow:0 -23px 0 var(--link),0 23px 0 var(--link),23px 0 0 var(--link),-23px 0 0 var(--link),15px 15px 0 var(--link),-15px 15px 0 var(--link),15px -15px 0 var(--link),-15px -15px 0 var(--link);-webkit-transform:scale(0);transform:scale(0);transition:all .3s ease}.dark-mode-toggle input:checked+div{box-shadow:inset 32px -32px 0 0 #fff;-webkit-transform:scale(.5) rotate(0deg);transform:scale(.5) rotate(0deg);transition:box-shadow .2s ease 0s,-webkit-transform .3s ease .1s;transition:transform .3s ease .1s,box-shadow .2s ease 0s;transition:transform .3s ease .1s,box-shadow .2s ease 0s,-webkit-transform .3s ease .1s}.dark-mode-toggle input:checked+:before{background:var(--link);transition:background .3s ease .1s}.dark-mode-toggle input:checked+:after{-webkit-transform:scale(1.5);transform:scale(1.5);transition:-webkit-transform .5s ease .15s;transition:transform .5s ease .15s;transition:transform .5s ease .15s,-webkit-transform .5s ease .15s}.graph-button{border:0;background:none;cursor:pointer}.graph-button svg g{stroke:var(--link)}.searchWrapper{position:relative;display:block}.inputWrapper{position:relative;color:var(--text)}.inputWrapper .searchIcon{position:absolute;fill:var(--link);left:2px;height:34px;padding:2px 2px 0;pointer-events:none}.inputWrapper input{color:var(--text);font-size:1rem;border:none;height:36px;padding-left:28px;background-color:var(--note-bg);transition:all .3s ease-in-out;width:28px}.inputWrapper input:focus{outline:none;width:100%}.results{-webkit-padding-start:0;padding-inline-start:0;position:absolute;display:block;top:100%;right:0;width:500px;max-height:50vh;background:var(--note-bg);box-shadow:-5px -5px 15px -3px var(--shadow),0 4px 6px -2px rgba(0,0,0,.05);overflow-y:auto;border-radius:8px}.results li{display:block;text-decoration:none;cursor:pointer;padding:16px 24px;border-bottom:1px solid var(--separator)}.results li:hover{background:var(--references-bg)}.results li .title{color:var(--text)}.results li .excerpt{color:var(--references-text)}@media screen and (max-width:600px){.results{right:-85px;width:calc(100vw - 40px)}}.lds-dual-ring:after{content:" ";left:calc(50% - 32px);position:relative;display:block;width:64px;height:64px;margin:8px;border-radius:50%;border-color:var(--separator);border-left:6px solid transparent;border-bottom:6px solid var(--separator);border-right:6px solid transparent;border-top:6px solid var(--separator);-webkit-animation:lds-dual-ring 1.2s ease-in-out infinite;animation:lds-dual-ring 1.2s ease-in-out infinite}@-webkit-keyframes lds-dual-ring{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes lds-dual-ring{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}header{width:100%;min-height:57px;z-index:5;background-color:var(--note-bg);border-bottom:1px solid var(--separator);display:flex;justify-content:space-between;align-items:center;padding:10px 32px;flex-wrap:wrap;transition:background-color .3s ease}header>a{font-weight:700;color:var(--text);text-decoration:none;transition:color .3s ease}header .controls{display:flex}html{font-family:system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5}body.light-mode{--main-bg:#fafafc;--note-bg:#fff;--text:#1a202c;--separator:#e2e8f0;--shadow:rgba(0,0,0,0.1);--link:#3182ce;--references-bg:#ebf4ff;--references-bg-80:rgba(235,244,255,0.8);--references-bg-0:rgba(235,244,255,0);--references-text:#718096;--references-highlight:#4a5568}body.dark-mode{--main-bg:#000;--note-bg:#0a0d11;--text:#fafafc;--separator:#252525;--shadow:hsla(0,0%,100%,0.1);--link:#3da1ff;--references-bg:#17181a;--references-bg-80:rgba(23,24,26,0.8);--references-bg-0:rgba(23,24,26,0);--references-text:#8c9fbb;--references-highlight:#b3cbf0}body{background-color:var(--main-bg);color:var(--text);margin:0;padding:0;height:100vh;transition:background-color .3s ease,color .3s ease}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,p,pre{margin:0}*,:after,:before{box-sizing:border-box}h1,h2,h3{font-weight:700}hr{margin-top:1rem;margin-bottom:1rem;border:solid var(--separator);border-width:1px 0 0;box-sizing:content-box;height:0;overflow:visible}a{color:var(--link);text-decoration:underline;transition:color .3s ease}a:hover{text-decoration:none}h1{font-size:1.875rem;margin-top:1rem}h1,p{margin-bottom:1rem}.layout{height:100vh;display:flex;flex-direction:column}.note-columns-scrolling-container{display:flex;overflow-x:auto;overflow-y:hidden;flex-grow:1}.note-columns-container{display:flex;flex-grow:1;transition:width .1s cubic-bezier(.19,1,.22,1)}@media screen and (max-width:800px){.note-columns-container{width:unset!important}}.overlay{z-index:98;position:fixed;top:0;right:0;bottom:0;left:0;display:flex;align-items:center;justify-content:center;height:100%;width:100%;background-color:var(--shadow);-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal{z-index:99;position:fixed;border-radius:8px;background-color:var(--main-bg);box-shadow:-5px -5px 15px -3px var(--shadow),0 4px 6px -2px rgba(0,0,0,.05)}.modal-close,.modal-scale{position:absolute;top:0;right:0;padding:5px;border:0;background:none;color:var(--text);cursor:pointer}.modal-close svg,.modal-scale svg{width:20px;height:20px}.modal-close path,.modal-scale path{fill:currentColor}.modal-scale{right:30px}.modal-minimized .modal-close svg,.modal-minimized .modal-scale svg{width:15px;height:15px}.modal-minimized .modal-scale{right:25px}.modal-body{height:100%;width:100%}.modal-body .node,.modal-body .text{cursor:pointer}</style><meta name="generator" content="Gatsby 2.32.13"/><link as="script" rel="preload" href="/ml-reviews/component---node-modules-gatsby-theme-garden-src-templates-local-file-js-b333e350c76f6649f3b0.js"/><link as="script" rel="preload" href="/ml-reviews/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/ml-reviews/app-b486d8a02537589426e3.js"/><link as="script" rel="preload" href="/ml-reviews/framework-06f646d936b841f99ebd.js"/><link as="script" rel="preload" href="/ml-reviews/webpack-runtime-8eab038b4b8d02ee63d6.js"/><link as="fetch" rel="preload" href="/ml-reviews/page-data/notes/scalable-uncertainties-from-deep-ensembles/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/ml-reviews/page-data/sq/d/2098632890.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/ml-reviews/page-data/sq/d/2221750479.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/ml-reviews/page-data/sq/d/2468095761.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/ml-reviews/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="layout"><header><a href="/ml-reviews/"><h3>ML Reviews</h3></a><div class="controls"><div class="searchWrapper" role="combobox" aria-expanded="false" aria-haspopup="listbox" aria-labelledby="downshift-24-label"><div class="inputWrapper"><svg class="searchIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M23.111 20.058l-4.977-4.977c.965-1.52 1.523-3.322 1.523-5.251 0-5.42-4.409-9.83-9.829-9.83-5.42 0-9.828 4.41-9.828 9.83s4.408 9.83 9.829 9.83c1.834 0 3.552-.505 5.022-1.383l5.021 5.021c2.144 2.141 5.384-1.096 3.239-3.24zm-20.064-10.228c0-3.739 3.043-6.782 6.782-6.782s6.782 3.042 6.782 6.782-3.043 6.782-6.782 6.782-6.782-3.043-6.782-6.782z"></path></svg><input type="text" aria-autocomplete="list" aria-labelledby="downshift-24-label" autoComplete="off" value="" id="downshift-24-input" placeholder="Search..."/></div></div><button title="Show Graph visualisation" aria-label="Show Graph visualisation" class="graph-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><g fill="none" stroke-width="2"><circle cx="11.733" cy="3.181" r="1.902"></circle><circle cx="16.864" cy="10.861" r="1.902"></circle><circle cx="7.47" cy="16.822" r="1.902"></circle><circle cx="3.046" cy="6.275" r="1.902"></circle><circle cx="9.372" cy="10.861" r="1.902"></circle><line x1="11.635" x2="14.655" y1="10.861" y2="10.861"></line><line x1="10" x2="10.895" y1="8.959" y2="5.573"></line><line x1="7.47" x2="4.5" y1="9.68" y2="7.5"></line><line x1="8.25" x2="8.809" y1="14.92" y2="13.088"></line></g></svg></button><label class="dark-mode-toggle" aria-label="Activate dark mode" title="Activate dark mode"><input type="checkbox" checked=""/><div></div></label></div></header><div class="note-columns-scrolling-container"><div class="note-columns-container" style="width:1250px"><div class="note-container   " style="left:0;right:-585px"><div class="note-content"><h1 id="scalable-uncertainties-from-deep-ensembles">scalable-uncertainties-from-deep-ensembles</h1><h2 id="arxiv"><a target="_blank" rel="noopener noreferrer" href="https://arxiv.org/abs/1612.01474v3">arxiv</a></h2><p><em>First written</em>: Aug/20/2021, 09:32:40</p><h2 id="summary">Summary</h2><ul><li>While <a href="/ml-reviews/neural-networks" title="neural networks">[[neural networks]]</a> are good at a wide range of tasks, they aren&#x27;t good at knowing <em>when</em> and <em>what</em> they don&#x27;t know.</li><li>Part of the problem with this is that there is no ground truth for uncertainty; not something that can be easily testable. <strong>Same problem associated with quantifying #generalization since the data we need is by definition not available to us.</strong></li><li>This paper looks at using two ways to measure uncertainty from neural networks: <a href="/ml-reviews/calibration" title="calibration">[[calibration]]</a> and <a href="/ml-reviews/domain-shift" title="domain shift">[[domain shift]]</a> or &quot;out-of-distribution examples&quot;.</li><li>Interpretation of <a href="/ml-reviews/dropout" title="dropout">[[dropout]]</a> uncertainties by Gal and Ghahramani as both <a href="/ml-reviews/MCMC" title="MCMC">[[MCMC]]</a> sampling, as well as &quot;creation&quot; of [<a title="ensembles" href="/ml-reviews/notes/ensembles">ensembles</a>] of neural networks.</li><li>Fundamentally, the question is whether or not ensembles of neural networks are any good at providing good uncertainty estimates.<ul><li><blockquote><p><a href="/ml-reviews/bayesian-model-averaging" title="bayesian model averaging">[[bayesian model averaging]]</a> assumes that the true model lies within the hypothesis class of the prior, and performs <em>soft model selection</em> to find the single best model within the hypothesis class.</p></blockquote></li><li><blockquote><p>...ensembles can be expected to be better when the true model does not lie within the hypothesis class.</p></blockquote></li></ul></li><li>A deep ensemble is supposed to be easier to implement and train than [<a title="bayesian-neural-networks" href="/ml-reviews/notes/bayesian-neural-networks">bayesian-neural-networks</a>], either variational or MCMC.</li></ul><h3 id="calibration">Calibration</h3><ul><li>This figure shows the performance of the approach w.r.t. a simple 1D regression task, where $y = x^3 + \varepsilon$ <span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:561px">
      <a class="gatsby-resp-image-link" style="display:block" href="/ml-reviews/ml-reviews/static/d3557e106e6bf95b5ddd8b8da67259ff/f0685/2021-08-20-10-38-27.png">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:38.57142857142858%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABf0lEQVQoz01Si26DMAzk/z+uK4XSFzBV5RVCgEIbIEBvdtikIVm2L3fGB3GmacIwDDCzgTEGWo+2Hwmf5xkTYa+X3jhUMzYMpNEDWMsYa7n+fD5wtNYYf8ld26MULQ3oMY4jzDjhcc+R55IENID6vuuRJhJClNSPmEmnZI0ovIMfp+97SKHQqhbv7m0HCyGR3DM0RHzSS7R+I3nkEGmBpmqx0JaPJMU3DXk9e1SlQl03NI425FWb5oVlma0dYybU6mltrp/V2mEXSnV0Nlseh5QVDaHh62KDtXbDsiyJXCFJErJbElHayPMMks8qRXVOYgVRCBRFAdbUdW3rgs7+cP5Mjrvf43gM4Hs+Dq6LIAhs9jwP3uEA3/fxtdvB3bvEO264t+F71lJm3m73hbZ9wmFSHMcIwxDn0wnn8xmXy4XyyYqvVHMfhjfEUYzb7YYoimxciHu9Xi3Gwf/DYatsKeWc5dZ6VVXIstTi3Kdpiq7rtititivyP7Zvb7CuK34AxPVYhKbTrVgAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="2021 08 20 10 38 27" title="2021 08 20 10 38 27" src="/ml-reviews/static/d3557e106e6bf95b5ddd8b8da67259ff/410f3/2021-08-20-10-38-27.png" srcSet="/ml-reviews/static/d3557e106e6bf95b5ddd8b8da67259ff/0d3e1/2021-08-20-10-38-27.png 140w,/ml-reviews/static/d3557e106e6bf95b5ddd8b8da67259ff/6b1e2/2021-08-20-10-38-27.png 281w,/ml-reviews/static/d3557e106e6bf95b5ddd8b8da67259ff/410f3/2021-08-20-10-38-27.png 561w,/ml-reviews/static/d3557e106e6bf95b5ddd8b8da67259ff/f0685/2021-08-20-10-38-27.png 835w" sizes="(max-width: 561px) 100vw, 561px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span><ul><li>First panel is empirical variance. <strong>Probably not much because each NN converges to the same weights?</strong></li><li>Second panel is training NLL using a single NN, third smooths the process with adversarial training.</li><li>Final panel combines NLL + AT with five NNs.</li></ul></li><li>Other comparison made is on a few tabular datasets; deep ensembles typically have larger RMSE but better NLL.</li></ul><h3 id="domain-shift">Domain shift</h3><ul><li>Test predictions on data from <em>unseen</em> classes: uncertainties should be proportional to distance from training data.</li><li>Model is trained on a standard <a href="/ml-reviews/MNIST" title="MNIST">[[MNIST]]</a> train/test split, however an additional testing class of <a href="/ml-reviews/NotMNIST" title="NotMNIST">[[NotMNIST]]</a>.</li><li><blockquote><p> We do not have access to the true conditional probabilities, but we expect the predictions to be closer to uniform on unseen classes compared to the known classes where the predictive probabilities should concentrate on the true targets</p></blockquote></li><li>The left panel shows how the distribution in <a href="/ml-reviews/entropy" title="entropy">[[entropy]]</a> is much broader/uniform for the ensemble + AT case, compared to the dropout uncertainties which are also much more discrete. <span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:355px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:80%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACNElEQVQ4y42UW3ObMBCF/f//TB86fel7n9rpJG0mNW58wWDuIEAgcRE6XckmxYlnYs0wsOjo26PLagVqeZZit93CcRys1w62ux0YK3E4uJBSYm5SCmxI4/u+1TrOBru9a+OqrKxmpZTCMAyQbQshBDpeQVYMg2gtbBxHaK3tY76HTqLvOoiGoykyqxdNY7UTsSxQTxOmIrYZpppBFSkUQeu6xmT65of6dZVDyxYYehqTUlygrUr0ZMpoVsoIxwFj4p9dtA0GA6KMSZKgJdc20QWo8hhTy6HIbV9XUDQzXjJkeW7Hn4GUTaUBNA3oeY2uLC24oakIIf8DtQFGlKyF6nvSMQvtKCnnfOGw7zAS8Fabp6vfAG81ZdfwAlQX4LwB82PXmN4GqkychZg6+U5r+z8CzlmvgbQ0/TVw/r4CjncDyeE9wI8dKrtp/PkBXRrf51BfOrB4vwUW37+hz9OzxmzWLaCiKZjde91ZOkZ6sXPLg80ef6ANTxTrV/28JKaSVva3GjD4OygqJ+Hu0bxsIE6+UV4NMo2vfyP8+gXe509oSGtmt2yrqqqQUUVET49I188okxgNHdI68JEdjyiyDEJ26Okg51QN8fYF0cNPROs/iJ9+IfvrgMUxqqJAUbAz0Nw2e/cI1/PgnQJ7e7gUB0EATmXYUrV0dCEwVuDo+TiQzvVPiLOcYg97up04VZgFzlZzcpKSuyiibFR6YRCiZOxdNZgEWZogDEMwcmXqPSaH85r+A51Q2Fnq3NaHAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="2021 08 20 11 14 39" title="2021 08 20 11 14 39" src="/ml-reviews/static/ecad5890bae970f3f7bbfc2ef55b4fcd/526ee/2021-08-20-11-14-39.png" srcSet="/ml-reviews/static/ecad5890bae970f3f7bbfc2ef55b4fcd/0d3e1/2021-08-20-11-14-39.png 140w,/ml-reviews/static/ecad5890bae970f3f7bbfc2ef55b4fcd/6b1e2/2021-08-20-11-14-39.png 281w,/ml-reviews/static/ecad5890bae970f3f7bbfc2ef55b4fcd/526ee/2021-08-20-11-14-39.png 355w" sizes="(max-width: 355px) 100vw, 355px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
    </span></li><li>Define a &quot;confidence&quot; value $0 \leq \tau \leq 1$ defined as the highest probability of a class. <strong>It shouldn&#x27;t always be one for unseen examples.</strong> </li></ul><h2 id="strategy">Strategy</h2><ul><li><blockquote><p>Given the input features $x$, we use a neural network to model the probabilistic predictive distribution $p_\theta(y \vert x)$ over the labels, where $\theta$ are the parameters of the NN.</p></blockquote></li><li>Three steps:<ol><li>Use a proper <a title="scoring rule" href="/ml-reviews/notes/scoring rule">[[scoring rule]]</a>; $-S(p_\theta, y \vert x) \in \mathcal{L}$ where $S$ can be <a title="maximum likelihood" href="/ml-reviews/notes/maximum likelihood">[[maximum likelihood]]</a>/<a href="/ml-reviews/mean-squared-error" title="mean squared error">[[mean squared error]]</a>/<a href="/ml-reviews/softmax" title="softmax">[[softmax]]</a>. MSE is also known as the <a href="/ml-reviews/Brier-score" title="Brier score">[[Brier score]]</a>.</li><li><a title="Adversarial training" href="/ml-reviews/notes/Adversarial training">[[Adversarial training]]</a> to smooth the predictive distribution</li><li>Train an ensemble <strong>lol</strong></li></ol></li></ul><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:561px">
      <a class="gatsby-resp-image-link" style="display:block" href="/ml-reviews/ml-reviews/static/0e9de60ce54afb3da942ba2848707d3d/ace37/2021-08-20-10-33-20.png">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:30%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABGElEQVQY001Q2W6EMAzk//9t0VZbCIHlhhDCVegD2iIxtU1X6oPlI5PxjD3f93G7+QjDECpU0FpDRxEiCu7jWCMIAiRJgvT5FFzTNJimCeM4YhgGCecclmWB5/oeSikkcXyR/RHGlBV9fpNH6spMGBE+z3JUZYk8z2HaFlVVoaTe+3m90NKgpgFn21kCVsjSFF3Xoe8dhZXaWiuqRlJkuZf3XtTO8yzh8VDRdud6ZLSVAdu6ytaV8nEc2Pcd53nie9vE2kDBxMYYEcEzrp0b4H2R74/7HY/HA58UbLmuSrKnEdLtirwQdRuRsT1+Z6vxvxPxnB0KIR+SB0VRiiq21ZlODs3HN+ay9bbMeLZY17Xg5Vxcs0LC/QIRbbbSQ3ds4AAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="2021 08 20 10 33 20" title="2021 08 20 10 33 20" src="/ml-reviews/static/0e9de60ce54afb3da942ba2848707d3d/410f3/2021-08-20-10-33-20.png" srcSet="/ml-reviews/static/0e9de60ce54afb3da942ba2848707d3d/0d3e1/2021-08-20-10-33-20.png 140w,/ml-reviews/static/0e9de60ce54afb3da942ba2848707d3d/6b1e2/2021-08-20-10-33-20.png 281w,/ml-reviews/static/0e9de60ce54afb3da942ba2848707d3d/410f3/2021-08-20-10-33-20.png 561w,/ml-reviews/static/0e9de60ce54afb3da942ba2848707d3d/ace37/2021-08-20-10-33-20.png 666w" sizes="(max-width: 561px) 100vw, 561px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
  </a>
    </span></p><h3 id="regression">Regression</h3><ul><li>Typical regression NN will minimize MSE, i.e. the output corresponds to the regression mean. Here, the authors suggest to output <em>two values</em>: the predicted mean and variance. The variance is done via $\sigma = (1 + \exp(x)) + \varepsilon$ where $\varepsilon$ is a small positive number of numerical stability.</li><li>The <a title="negative log-likelihood" href="/ml-reviews/notes/negative log-likelihood">[[negative log-likelihood]]</a> criterion used:
$$ -\log p<em>\theta(y_n \vert x_n) = \frac{\log \sigma^2</em>\theta(x)}{2} + \frac{(y - \mu<em>\theta(x))^2}{2\sigma^2</em>\theta(x)} + C$$</li></ul><p>Julia implementation:</p><pre><code class="language-julia">begin
  function nll(mu, var, y)
    return log(var^2) / 2 + (y - mu)^2 / (2 * var^2) + eps(Float32)
  end
end
</code></pre><h3 id="adversarial-training">Adversarial training</h3><p>Basically use conventional <a title="fast gradient sign method" href="/ml-reviews/notes/fast gradient sign method">[[fast gradient sign method]]</a>, or <a title="virtual adversarial training" href="/ml-reviews/notes/virtual adversarial training">[[virtual adversarial training]]</a>.</p><h3 id="ensemble-training">Ensemble training</h3><ul><li>Choice between <a href="/ml-reviews/decision-trees" title="decision trees">[[decision trees]]</a> or [<a title="boosting" href="/ml-reviews/notes/boosting">boosting</a>]; the authors chose the former because they are much better for distributed training.</li><li>There is an extensive discussion into decorrelation of trees with <a href="/ml-reviews/bootstrapping" title="bootstrapping">[[bootstrapping]]</a>; the authors instead just use random initialization of the parameters, and shuffle the training data points for each &quot;tree&quot; in practice.</li><li>Apparently [<a title="stochastic-multiple-choice-learning" href="/ml-reviews/notes/stochastic-multiple-choice-learning">stochastic-multiple-choice-learning</a>] helps with de-correlating the NN &quot;trees&quot;.</li><li>Ensemble as a uniformly-weighted <a href="/ml-reviews/mixture-model" title="mixture model">[[mixture model]]</a><ul><li>For classification, averaging the predicted probabilities</li><li>For regression, Gaussian mixture, with a mixture mean $\mu<em>*(x)$ and variance $\sigma</em>*(x)$</li></ul></li></ul><p>$$\mu<em>*(x) = \frac{1}{M}\sum_m \mu</em>{\theta_m}(x)$$</p><p>$$\sigma<em>*^2(x) = \frac{1}{M}\sum_m(\sigma^2</em>{\theta<em>m}(x) + \mu^2</em>{\theta<em>m}(x)) - \mu</em>*^2(x)$$</p><p>A naive Julia implementation:</p><pre><code class="language-julia">begin
  &quot;&quot;&quot;Reduce the predictions from each tree into an ensemble
  mean and variance. Assumes `means` and `vars` are a list
  of vectors.
  &quot;&quot;&quot;
  function reduce_ensemble(means, vars)
    means = reduce(hcat, means)
    ensemble_mean = mean(means, dims=2)
    vars = reduce(hcat, vars)
    ensemble_var = mean(means.^2 .+ vars.^2, dims=2) .- ensemble_mean.^2
    return ensemble_mean, ensemble_var
  end

  &quot;&quot;&quot;Given a struct `ensemble`, and inputs `x`, we loop over
  each tree in the ensemble/forest (also assuming tree is a functor)
  and collect up all of the means/variances predicted by each tree.
  We then bag the results.
  &quot;&quot;&quot;
  function predict(x, ensemble)
    means, vars = [], []
    for tree in ensemble.forest
      mean, var = tree(x)
      push!(means, mean)
      push!(vars, var)
    end
    ensemble_mean, ensemble_var = reduce_ensemble(means, vars)
  end
end
</code></pre><h2 id="comments">Comments</h2><ul><li>Good for #distributed training; maybe a good use case for #intel-research.</li><li>5 NN&#x27;s seem good enough for uncertainty estimation, but not sure how this really actually scales for real tasks.</li><li>How does it really fit into a hypothesis testing context?</li></ul><p>[scoring rule]<!-- -->: scoring rule &quot;scoring rule&quot;
<!-- -->[maximum likelihood]<!-- -->: maximum likelihood &quot;maximum likelihood&quot;
<!-- -->[Adversarial training]<!-- -->: Adversarial training &quot;Adversarial training&quot;
<!-- -->[negative log-likelihood]<!-- -->: negative log-likelihood &quot;negative log-likelihood&quot;
<!-- -->[fast gradient sign method]<!-- -->: fast gradient sign method &quot;fast gradient sign method&quot;
<!-- -->[virtual adversarial training]<!-- -->: virtual adversarial training &quot;virtual adversarial training&quot;</p><div class="references-block"><h3>Referred in</h3><div><div><a class="reference" href="/ml-reviews/notes/scoring rule"><div><h5>scoring rule</h5></div></a></div><div><a class="reference" href="/ml-reviews/readme"><div><h5>ML Reviews</h5></div></a></div></div></div></div><a aria-current="page" class="obstructed-label" href="/ml-reviews/notes/scalable-uncertainties-from-deep-ensembles">scalable-uncertainties-from-deep-ensembles</a></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/notes/scalable-uncertainties-from-deep-ensembles";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-b26ca15045427b9506aa.js"],"app":["/app-b486d8a02537589426e3.js"],"component---node-modules-gatsby-theme-garden-src-templates-local-file-js":["/component---node-modules-gatsby-theme-garden-src-templates-local-file-js-b333e350c76f6649f3b0.js"]};/*]]>*/</script><script src="/ml-reviews/polyfill-b26ca15045427b9506aa.js" nomodule=""></script><script src="/ml-reviews/webpack-runtime-8eab038b4b8d02ee63d6.js" async=""></script><script src="/ml-reviews/framework-06f646d936b841f99ebd.js" async=""></script><script src="/ml-reviews/app-b486d8a02537589426e3.js" async=""></script><script src="/ml-reviews/styles-407fe62976dc5310c43e.js" async=""></script><script src="/ml-reviews/component---node-modules-gatsby-theme-garden-src-templates-local-file-js-b333e350c76f6649f3b0.js" async=""></script></body></html>